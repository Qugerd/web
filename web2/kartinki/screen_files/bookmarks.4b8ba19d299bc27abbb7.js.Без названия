!function(e){function a(a){for(var o,n,i=a[0],l=a[1],u=a[2],d=0,g=[];d<i.length;d++)n=i[d],t[n]&&g.push(t[n][0]),t[n]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(c&&c(a);g.length;)g.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,a=0;a<s.length;a++){for(var r=s[a],o=!0,i=1;i<r.length;i++){var l=r[i];0!==t[l]&&(o=!1)}o&&(s.splice(a--,1),e=n(n.s=r[0]))}return e}var o={},t={"web/bookmarks":0},s=[];function n(a){if(o[a])return o[a].exports;var r=o[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=o,n.d=function(e,a,r){n.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,a){if(1&a&&(e=n(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var o in e)n.d(r,o,function(a){return e[a]}.bind(null,o));return r},n.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(a,"a",a),a},n.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},n.p="/js/cmodules/";var i=window.webpackJsonp=window.webpackJsonp||[],l=i.push.bind(i);i.push=a,i=i.slice();for(var u=0;u<i.length;u++)a(i[u]);var c=l;s.push([114,"bundles/common","bundles/028bfab8c6a4c40a39372d9a5126be84"]),r()}({114:function(e,a,r){e.exports=r("mG/L")},"mG/L":function(e,a,r){"use strict";r.r(a);r("OG14"),r("pIFo");var o,t,s,n,i,l,u,c=r("v+DW"),d=r("EasH"),g=r("4+be"),m=r("XzvV"),_=r("BJj/"),k=r("h8oe"),p=r("RJa5"),b=r("zxIV"),h={init:(e,a,r,o,c,d,g)=>{if(t=e,i=a,l=r,s=c,n=d,u=o,extend(cur,{tabsEl:geByClass1("ui_tabs",geByClass1("bookmark_block")),indexer:!1,autoList:!1,pagesAllLoadCounter:0,pagesAll:[],pagesAfterLoadCallback:!1,currentSearchResult:!1,currentSearchQuery:"",filterOnlines:!1,isPagesBookmarks:"user"==i||"group"==i,pagesTags:{}}),cur.module="bookmarks",h.initTagSort(),window.ArticleLayer&&window.ArticleLayer.clearPrepared(),cur.isPagesBookmarks?(h._loadPagesAll(),h._initPagesTooltipTags()):h._initAutoList(),h._focusSearchInput(),h._initPagesTrack(),nav.objLoc.from_menu){var m=clone(nav.objLoc);delete m.from_menu;var _=nav.toStr(m);window.history.replaceState({},document.title,"/"+_)}Object(k.trackMarketArea)(p.AnalyticsArea.BOOKMARKS)},_focusSearchInput:()=>{var e=ge("bookmarks_pages_search");e&&elfocus(e)},_initAutoList:()=>{var e=geByClass1("bookmarks_rows");e&&(cur.isPagesBookmarks&&(e.innerHTML=""),cur.autoList&&cur.autoList.destroy(),cur.autoList=new window.AutoList(e,{rowClasses:["bookmarks_row"],renderImmediate:cur.isPagesBookmarks,offset:cur.isPagesBookmarks?0:u,onNoMore:a=>{if(0==a&&cur.isPagesBookmarks){var r="";cur.filterOnlines&&(r=Object(g.getLang)("fave_no_users_online")),cur.currentSearchQuery&&(r=Object(g.getLang)("fave_query_not_found").replace("{search}",clean(cur.currentSearchQuery))),cur.currentSearchQuery||cur.filterOnlines||nav.reload(),e.innerHTML=`\n              <div class="no_rows">${r}</div>\n            `}},onNeedRows:(e,a)=>{if(cur.isPagesBookmarks){for(var r=[],o=a;o<cur.pagesAll.length;o++){var t=cur.pagesAll[o],s=domData(t,"id");if((!1===cur.currentSearchResult||inArray(s,cur.currentSearchResult))&&((!cur.filterOnlines||hasClass(t,"bookmark_online"))&&(r.push(t),r.length==u)))break}e(r)}else ajax.post("bookmarks",{act:"more",offset:a,type:i,tag:l},{onDone:a=>{e(a,u)}})}}),h._initPagesSearch(),cur.destroy.push(()=>{cur.autoList.destroy()}))},onPagesTabOnlineChoose:()=>{if(!cur.autoList)return uiTabs.showProgress(cur.tabsEl),cur.pagesAfterLoadCallback=()=>{h.onPagesTabOnlineChoose()},!1;cur.filterOnlines=!0,h._initAutoList()},onPagesTabAllChoose:()=>{if(!cur.autoList)return uiTabs.showProgress(cur.tabsEl),cur.pagesAfterLoadCallback=()=>{h.onPagesTabAllChoose()},!1;cur.filterOnlines=!1,h._initAutoList()},onPagesSearch:Object(_.debounce)(e=>{if(e=trim(e)){if(!1===cur.indexer)return uiTabs.showProgress(cur.tabsEl),void(cur.pagesAfterLoadCallback=()=>{h.onPagesSearch(e)});cur.currentSearchResult=[];for(var a=cur.indexer.search(e),r=0;r<a.length;r++)cur.currentSearchResult.push(a[r].id);"user"===nav.objLoc.type?Object(m.saveSearchAttemptStats)("bookmarks_users",0,a.length,e):"group"===nav.objLoc.type&&Object(m.saveSearchAttemptStats)("bookmarks_groups",0,a.length,e)}else cur.pagesAfterLoadCallback=!1,cur.currentSearchResult=!1,h._initAutoList();cur.currentSearchQuery=e,h._initAutoList()},200),_initPagesSearch:()=>{if(!cur.indexer&&cur.isPagesBookmarks){for(var e=[],a=0;a<cur.pagesAll.length;a++){var r=cur.pagesAll[a],o=geByClass1("mem_link",r)||geByClass1("group_link",r);if(!o)return;e.push({id:domData(r,"id"),name:o.innerHTML,online:!!hasClass("bookmark_online",r)})}cur.indexer=new vkIndexer(e,e=>e.name)}},_loadPagesAll:()=>{if(!(cur.pagesAllLoadCounter>5)){var e=i;ajax.post("al_bookmarks.php",{act:"load_all",type:i,offset:1e3*cur.pagesAllLoadCounter},{onDone:a=>{if(i==e)if(a.length>0){for(var r=0;r<a.length;r++)cur.pagesAll.push(se(a[r]));h._loadPagesAll()}else uiTabs.hideProgress(cur.tabsEl),h._initAutoList(),h._initPagesTooltipTags(),cur.pagesAfterLoadCallback&&cur.pagesAfterLoadCallback()}}),cur.pagesAllLoadCounter++}},_initPagesTooltipTags:()=>{cur.pagesTags={};for(var e=0;e<cur.pagesAll.length;e++){var a=cur.pagesAll[e],r=JSON.parse(domData(a,"tags")),o=domData(a,"id");cur.pagesTags[o]={};for(var t=0;t<r.length;t++)cur.pagesTags[o][r[t].id]=r[t].name}},_initPagesTrack:()=>{var e=geByClass1("bookmarks_rows_user")||geByClass1("bookmarks_rows_group");e&&e.addEventListener("click",e=>{var a=Object(b.domClosestByTag)("a",e.target);if(a&&a.href){var r=a.href;ajax.post("al_bookmarks.php",{act:"track_page",page:r,hash:s})}},!0)},editTag:(e,a)=>{cancelEvent(e);var r=showBox("/al_bookmarks.php",{act:"add_tag_box",tag_id:a},{onDone:()=>{var e=ge("bookmark_tag_name");elfocus(e),addEvent(e,"keypress",e=>{e.keyCode==KEY.ENTER&&ge("save_tag_btn").click()})},params:{width:"350px"}}),o=!a,t=e.target.parentNode;r.removeButtons().addButton(Object(g.getLang)("global_save"),function(e){var s=geByTag1("input",r.bodyNode),i=domData(s,"hash"),l=trim(s.value).substr(0,n);l&&(Object(c.lockButton)(e),ajax.post("/al_bookmarks.php",{act:"edit_tag",tag:l,tag_id:a,hash:i},{onDone:(e,a,s)=>{r.hide();var n=geByClass1("ui_rmenu"),i=se(a);if(domReplaceEl(n,i),h.initTagSort(),each(geByClass("bookmark_tag_"+e),(e,a)=>{a.innerHTML=clean(l)}),each(domQuery(`.bookmark_tag_menu_item[data-tag-id="${e}"]`),(e,a)=>{a.innerHTML=clean(l),domData(a,"tag-name",l)}),o&&each(geByClass("bookmarks_actions_menu"),(a,r)=>{r=geByClass1("ui_actions_menu_sublist",r);var o=geByClass1("bookmark_tag_menu_item_sample",r),s=o.cloneNode();domData(s,"tag-id",e),domData(s,"tag-name",l),removeClass(s,"bookmark_tag_menu_item_sample"),s.innerHTML=clean(l),domInsertBefore(s,o),t==r&&h.setBookmarkTag(s)}),e){var u=domQuery1(`.ui_crumb[data-tag-id="${e}"]`);u&&(u.innerHTML=clean(l))}h.udpateNewTagAction(s)}}))},null,null,"save_tag_btn").addButton(Object(g.getLang)("global_cancel"),!1,"no")},removeTag:(e,a,r,o)=>{var t=Object(g.getLang)("fave_tag_delete_text").replace("{tag_name}",clean(replaceEntities(o)));return Object(d.showFastBox)(Object(g.getLang)("fave_tag_delete_title"),t,Object(g.getLang)("global_yes"),function(){h.doRemoveTag(e,a,r)},Object(g.getLang)("global_cancel")),cancelEvent(e)},doRemoveTag:(e,a,r)=>{cancelEvent(e),ajax.post("/al_bookmarks.php",{act:"remove_tag",tag_id:a,hash:r}),re(geByClass1("_ui_item_tag__"+a)),each(geByClass("bookmark_tag_"+a),(e,a)=>{var r=gpeByClass("bookmark_footer",a),o=gpeByClass("bookmark_tags",a);re(a),toggle(r,trim(o.innerHTML))}),each(domQuery(`[data-tag-id="${a}"]`),(e,a)=>{re(a)}),each(cur.pagesTags,(e,r)=>{delete r[a]}),h.udpateNewTagAction(!0),curBox()&&curBox().hide()},udpateNewTagAction:e=>{each(geByClass("bookmark_tag_menu_item_new"),(a,r)=>{toggleClass(r,"force_unshown",!e)}),toggleClass(geByClass1("bookmarks_right_menu_button"),"force_unshown",!e)},setBookmarkTag:function(e,a){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=domData(e,"bookmark-id"),t=domData(e,"item-type"),s=domData(e,"item-oid"),n=domData(e,"item-id"),i=domData(e,"tag-id"),l=domData(e,"tag-name"),u=domData(e,"hash"),c=ge("bookmark_footer_"+o),m=ge("bookmark_tags_"+o),_=intval(domData(e,"tagged"));_?re(geByClass1(`bookmark_tag_${i}`,m)):m&&m.appendChild(ce("a",{href:`/bookmarks?tag=${i}`,className:`bookmark_tag bookmark_tag_${i}`,innerHTML:clean(l)})),m&&toggle(c,trim(m.innerHTML)),domData(e,"tagged",_?0:1);var k=cur.pagesTags[n]||{};return _?delete k[i]:k[i]=l,r||ajax.post("/al_bookmarks.php",{act:"set_tag",item_type:t,item_oid:s,item_id:n,tag_id:i,hash:u,is_tagged:_},{onFail:r=>(h.setBookmarkTag(e,a,!0),Object(d.showFastBox)(Object(g.getLang)("global_error"),r),!0)}),cancelEvent(a)},onActionMenuToggle:e=>{cur.isPagesBookmarks&&each(geByClass("bookmarks_actions_menu"),(a,r)=>{e?hasClass(r,"shown")||hide(r):show(r)})},initTagSort:()=>{o&&o.destroy(),o=new window.GridSorter(ge("ui_rmenu_tags_dropdown_list"),{onReorder:()=>{for(var e=geByClass1("_ui_rmenu_tags_dropdown_list"),a=[],r=0;r<e.children.length;r++){var o=domData(e.children[r],"id");o&&a.push(o)}ajax.post("al_bookmarks.php",{act:"reorder_tags",tag_ids:a.join(","),hash:t})}})},showAddLinkDialog:()=>{var e;function a(e){Object(c.disableButton)(r.btns.ok[0],!e)}var r=showBox("/al_bookmarks.php",{act:"add_link_box"},{onDone:(r,o)=>{e=o.addHash;var t,s=geByTag1("input",r.bodyNode),n=geByClass1("bookmarks_add_link_box__preview",bodyNode);s.focus(),s.addEventListener("input",()=>{clearTimeout(t),t=setTimeout(()=>{!function(e){var t=extractUrls(e,!0);if(t.length&&t[0].url){a(!1);var s=t[0].url,i=r.bodyNode,l=geByClass1("bookmarks_add_link_box__share_utils",i);l.innerHTML="",l.appendChild(se('<iframe class="bookmarks_share_parse_iframe" name="bookmarks_share_parse_iframe"></iframe>'));var u=l.appendChild(ce("form",{action:"share.php?act=url_attachment",method:"post",target:"bookmarks_share_parse_iframe"}));u.appendChild(ce("input",{type:"hidden",name:"hash",value:o.shareHash})),u.appendChild(ce("input",{type:"hidden",name:"url",value:s})),u.appendChild(ce("input",{type:"hidden",name:"index",value:1})),window.onUploadFail=()=>{cur.linkAddedUrl=s,a(!0)},window.onUploadDone=e=>{if(e){var r=e[2],o="";r.cover&&(r.images_proxy_url&&r.images_proxy.length?o=r.images_proxy_url+r.images_proxy[0]:r.thumb?o=r.thumb:r.thumb_m&&(o=r.thumb_m)),function(e){e?(n.style.backgroundImage=`url(${e})`,removeClass(n,"no_cover")):addClass(n,"no_cover")}(o),cur.linkAddedUrl=cur.linkAddedUrl||s,cur.linkAddedTitle=cur.linkAddedTitle||r.title_plain||r.title,cur.linkAddedCover=cur.linkAddedCover||r.cover}a(!0)},u.submit()}}(s.value)},1e3)})}});r.removeButtons().addButton(Object(g.getLang)("global_add"),a=>{ajax.post("al_bookmarks.php",{act:"bookmark_link",url:cur.linkAddedUrl,img:cur.linkAddedCover,title:cur.linkAddedTitle,hash:e,state:0},{showProgress:c.lockButton.bind(null,a),onDone:()=>{nav.reload(),r.hide()}})},"yes").addButton(Object(g.getLang)("global_close"),()=>{r.hide()},"no"),a(!1)},removeBookmark:function(e,a,r,o,t){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];ajax.post("bookmarks",{act:"remove_bookmark",hash:t,item_owner_id:r,item_id:o,item_type:a},{onDone:()=>{s&&s()}});for(var n=0;n<cur.pagesAll.length;n++){var i=cur.pagesAll[n],l=domData(i,"id");if(l==o){cur.pagesAll.splice(n,1),delete cur.indexer,window.Bookmarks._initPagesSearch();break}}if(e){var u=gpeByClass("bookmark_page_item",e);if(u)re(u),cur.autoList&&cur.autoList.drawMore();else{var c=gpeByClass("bookmarks_row",e),d=!!hasClass(domPN(c),"bookmark_block")&&domPN(c),g=d||c;g&&(g.previousSibling?(re(g),cur.autoList&&cur.autoList.drawMore()):nav.reload())}}h.onActionMenuToggle(!1)},getTagsTooltip:e=>{var a=[];each(cur.pagesTags[e]||{},(e,r)=>{a.push(r)});var r=a.length>3?"...":"";return(a=a.slice(0,3)).join(", ")+r}};window.Bookmarks=h;try{window.stManager.done(window.jsc("web/bookmarks.js"))}catch(e){}}});